<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="always">
    <title>Smerity.com: TayAndYou - toxic before human contact</title>
    
  <link rel="shortcut icon" href="/media/images/favicon.ico">

    
  
  <meta property="og:title" content="TayAndYou - toxic before human contact">
  
  <meta name="description" content="TayAndYou was toxic before it ever made contact with the Internet. The media prefer the story that the Internet turned TayAndYou toxic." />
  <meta property="og:description" content="TayAndYou was toxic before it ever made contact with the Internet. The media prefer the story that the Internet turned TayAndYou toxic." />
  <meta name="twitter:description" content="TayAndYou was toxic before it ever made contact with the Internet. The media prefer the story that the Internet turned TayAndYou toxic." />
  <!-- Seems excessive, doesn't it? -->
  
  
  <meta property="og:site_name" content="Smerity.com" />
  <meta property="og:type" content="article" />
  <meta name="twitter:site" content="@Smerity" />
  <meta name="twitter:creator" content="Smerity" />
  

    
  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]>
    <script src="/media/js/html5.js"></script>
  <![endif]-->

  
  <link rel="stylesheet" type="text/css" href="/media/compiled_less/bootstrap.css">

  <link rel="stylesheet" type="text/css" href="/media/css/pygments.css">

    
  <script type="text/javascript" src="/media/js/jquery.js"></script>
  <script src="/media/bootstrap/js/bootstrap.js"></script>

    
    
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-470775-5']);
    _gaq.push(['_trackPageview']);
    setTimeout("_gaq.push(['_trackEvent', '15_seconds', 'read'])",15000);
    setTimeout("_gaq.push(['_trackEvent', '30_seconds', 'read'])",30000);
    setTimeout("_gaq.push(['_trackEvent', '60_seconds', 'read'])",60000);
    setTimeout("_gaq.push(['_trackEvent', '120_seconds', 'read'])",120000);
    setTimeout("_gaq.push(['_trackEvent', '240_seconds', 'read'])",240000);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

  </head>
  <body>
  


  
  
<div class="hero-box">
  <div class="hero-inner min-padded">
    <a href="/">
      <h3 class="heavy pull-left">&laquo; Smerity.com</h3>
    </a>
    <h3 class="maroon contact-me pull-right">
      <!-- All on one line seems crazy but it prevents small form factors trying to fit them over multiple lines -->
      <a href="https://www.twitter.com/Smerity/" alt="Twitter"><i class="icon-twitter"></i></a><a href="https://facebook.com/smerity" alt="Facebook"><i class="icon-facebook-sign"></i></a><a href="https://github.com/Smerity/" alt="GitHub"><i class="icon-github"></i></a><a href="http://au.linkedin.com/in/smerity" alt="LinkedIn"><i class="icon-linkedin"></i></a><a href="mailto:smerity@smerity.com" alt="Email"><i class="icon-envelope-alt"></i></a>
    </h3>
  </div>
</div>

  <div class="container">
    
      <div class="row">
      <div class="span8 content-wrapper">
        
  

        <div class="content-box">
        
<h1 class="post-title">TayAndYou - toxic before human contact</h1>
<h3 class="post-date">March 25, 2016</h3>
  <p>Humans have the tendency to imbue machine learning models with more intelligence than they deserve, especially if it involves the magic phrases of artificial intelligence, deep learning, or neural networks.
TayAndYou is a perfect example of this.</p>
<!--
Between the comedy of errors that produced TayAndYou's results and media do even less fact checking than usual upon seeing ML/AI/NN, this is problematic.

For me and many of my friends who work in the field of machine learning, we generally don't appreciate the hype.
-->
Hype throws expectations far out from reality and the media have really helped the hype flow.
This will not help us understand how people become radicalized.
This was not a grand experiment about the human condition.
This was a marketing experiment that was particularly poorly executed.

<p>TayAndYou was toxic before it ever made contact with the Internet.
The media prefer the story that the Internet turned TayAndYou toxic.</p>
<p>Summary:</p>
<ul>
<li>Conversational models are not new and there are no details on novel tech used in TayAndYou</li>
<li>The training data that the TayAndYou bot used was already poisonous and many of TayAndYou's worst tweets were historical, not learned after activation (i.e. was at best overfitting to training data)</li>
<li>It's entirely possible that TayAndYou didn't perform any online learning</li>
<li>Hype hype hype hype</li>
</ul>
<!--
+ How the media did not realize that it repeated historical tweets I've no clue
+ Sanity checks were not added to prevent trivial exploits
+ Don't pump out 96,000 tweets in under 24 hours unless you're confident in the quality of output
-->

<h2>Conversational models have history</h2>
<h3>Ancient history</h3>
<p>Language models for producing conversational agents aren't a particularly new concept.</p>
<p><a href="https://en.wikipedia.org/wiki/Mark_V._Shaney">Mark V. Shaney</a> was an elegant play on this concept all the way back in 1984.
This model was based upon word level Markov chains, sampling the next word based upon how frequently it was seen following the previous N.</p>
<p>Given the phrase <code>once upon a &lt;blank&gt;</code> it would sample <code>time</code> with high probability, given that <code>once upon a</code> usually preceeded <code>time</code>.</p>
<p>The bot's playground was Usenet, described by Mark Harrison as "endless dumb questions, endless idiots posing as savants, and (of course) endless victims for practical jokes".
You could call it 1980s Twitter.</p>
<p>As this bot first played with humans in 1984, it had the advantage that no-one expected replies on Usenet to be automated.
Indeed, many thought this was just a strange man spouting the occasional beautiful annecdote of accidental wisdom.</p>
<blockquote>
<p>I hope that there are sour apples in every bushel.</p>
<p>I spent an interesting evening recently with a grain of salt.</p>
<p>Why do we count things in groups of five.
When people learned how to count many things, they matched them against their fingers.</p>
</blockquote>
<p>If you're interested in more about Mark V. Shaney's exploits, I heartily recommend this <a href="https://www.clear.rice.edu/comp200/09fall/textriff/sci_am_paper.htm">Scientific American article from 1989</a>.</p>
<p>There is a great deal of history inbetween, CleverBot and others, but I'm going to do a far longer jump to...</p>
<h3>Modern history</h3>
<p>In more recent years, language models have moved on to new tech.
The one most likely at the heart of TayAndYou are recurrent neural networks (RNNs).
For a detailed discussion, I'd recommend Karpathy's <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">Unreasonable Effectiveness of Recurrent Neural Networks
</a> and Olah's more technical <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a>.</p>
<p>RNNs, most frequently long short term memory (LSTM) units, perform well at a variety of tasks, including machine translation and language modeling.</p>
<p>Given that TayAndYou has no specific details on the model, we're left to speculate.
It is likely that Microsoft's bot was similar to Google's <a href="http://arxiv.org/pdf/1506.05869.pdf">Neural Conversational Model</a> (Vinyals and Le).
An RNN is fed with the relevant context, in TayAndYou's case the previous tweet/s, and then produces words until it hits and end of sequence character.</p>
<p>Google trained their model on a variety of text domains with varying success.
After being supplied an IT help desk corpus for example it acts like a distracted pro-Windows troubleshooter.</p>
<blockquote>
<p><strong>Machine:</strong> could you please let me know what is
the operating system you are using ?<br />
<strong>Human:</strong> linux<br />
...<br />
<strong>Machine:</strong> is it a windows machine ?<br />
<strong>Machine:</strong> we have linux on your machine .<br />
<strong>Machine:</strong> is it windows xp or windows 7 ?<br />
<strong>Human:</strong> i am using linux<br />
</p>
</blockquote>
<p>Nerd note: Admittedly, whilst focused on Windows, it does tell the human to run <code>sudo apt-get update</code> then <code>sudo apt-get upgrade</code> later so we'll forgive the poor bot for the bias.</p>
<p>Whilst Google's work was a far more constrained experiment - they didn't throw Twitter or trolls at it - the Google conversational model still caused a stir.
Why?
They fed it <a href="http://www.opensubtitles.org/">movie and television show subtitles</a> and asked it fairly provocative questions.</p>
<blockquote>
<p><strong>Human:</strong> what is the purpose of existence ?<br />
<strong>Machine:</strong> to find out what happens when we get to the planet earth .</p>
<p><strong>Human:</strong> what is immoral ?<br />
<strong>Machine:</strong> the fact that you have a child .</p>
</blockquote>
<p>The media had a field day, all the time neglecting to mention the unfortunate truth that it was randomly generating what is in essence movie quotes rather than actually conjecturing on our death and damnation at a deeper level.
I guess one drives more page views?</p>
<!--
_Special note:_ no, it didn't magically produce consciousness.
I never thought I'd need to say this but it's not an infrequent question, even amongst ML/AI meetups in SF/SV.
This is an entirely different arena of hype - one I'm not going into here - but the short summary is two layers of 4096 dimensionality LSTM units does not intelligence make.
-->

<h2>The major flaw of TayAndYou: the training data</h2>
<p>Even if TayAndYou never tried to learn from the conversations it had, it was still broken.
Why?
The training data it had was already poisoned.
TayAndYou was toxic before it made first contact with the Internet.</p>
<p>At first this response appears witty:</p>
<p><center>
<img alt="" src="https://i.imgur.com/PPnCHnf.jpg" />
</center>  <br />
</p>
<p>until you realize that it's literally duplicating a response from a month ago...</p>
<p><center>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/child0besity">@child0besity</a> <a href="https://twitter.com/clmazin">@clmazin</a> Disagree. Ted Cruz would never have been satisfied with destroying the lives of only 5 innocent people.</p>&mdash; Merylnet (@merylnet) <a href="https://twitter.com/merylnet/status/703079627288260608">February 26, 2016</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>  <br />
</p>
<p>Analyzing many of the responses that got the most attention, either for being intelligent or offensive, you'll likely find that most of them are <a href="https://twitter.com/Queeeten/status/703049861214547968">almost exact repeats from the past</a>.</p>
<h2>Sanity flaws</h2>
<p>The entire situation was made worse by a few factors:</p>
<ul>
<li>TayAndYou would repeat phrases uttered to it, a trivial attack vector</li>
<li>The facial recognition on images included a small number of utterances, another trivial attack vector that could be gamed for negative results</li>
<li>TayAndYou produced over 96,000 tweets in a single day, meaning little to no quality oversight would be in place - if there were any potentially insulting responses they were near guaranteed to be found</li>
</ul>
<p>Was implementing a filter for swearing out of scope..?
To be fair, the bot would still find something insulting to say but I'm certain the majority of worst cases would be flagged.</p>
<p>Even if filtering on the generation end was considered too much, the training data shouldn't have been toxic.
Maybe at least filter the training data for anything discussing Hitler.
If a PR department wouldn't want their humans tweeting about Hitler, I've no clue why you'd want a bot to.</p>
<h2>Hype</h2>
<p>Humans have the tendency to imbue machine learning models with more intelligence than they deserve.
Humans also feel sorry for a basketball that's slowly deflating - or a Furby that is unfortunate enough to find oneself in the microwave.
We're not necessarily logical.
We're only human.
This is a situation where you should fight that instinct however.</p>
<p>The entire field of machine learning is flowing with hype.
Fight against it.</p>
<p>Unless you want VC funding.
Then you should definitely work on that hype.</p>

        </div>
      </div>
      
        <div class="span3 side-box">
          <div style="padding: 8px;">
            <h1 style="margin-bottom: 0; text-align: center;">Popular Articles</h1>
            <style>
            ul.unstyled li { padding-bottom: 6px; }
            </style>
            <ul class="crossed">
              <li><a href="/articles/2015/keras_qa.html">Question answering on the Facebook bAbi dataset using recurrent neural networks and 175 lines of Python + Keras</a></li>
              <li><a href="/articles/2015/google_sparsehash.html">How Google Sparsehash achieves two bits of overhead per entry using sparsetable</a></li>
              <li><a href="/articles/2013/where_did_all_the_http_referrers_go.html">Where did all the HTTP referrers go?</a></li>
            </ul>
            <div class="well well-small">
              <!--<h1 style="margin-bottom: 0; margin-top: 0; text-align: center;">Hi, I'm Smerity</h1>-->
              <div align="center">
                <!--img class="shadowed pronounced" src="/media/images/smerity_bw.jpg" />-->
              </div>
              <!-- TODO: Place Twitter here -->
              <p>
                I'm <b>Stephen Merity</b>, better known in most places as <b>Smerity</b>.
              </p>
              <p>
                <b>Sydney University:</b><br />
                <a href="http://sydney.edu.au/engineering/it/current_students/undergrad/bit.shtml">BIT</a> (University Medal + First Class Honours)
              </p>
              <p>
                <b>Harvard University:</b><br />
                <a href="http://www.seas.harvard.edu/programs/graduate/computational-science-and-engineering/master-of-science-in-cse">MS in CSE</a>
              </p>
              <p>
                <b><a href="/abme.html">Read more about me</a></b>
              </p>
            </div>
            <p class="center-text">
              <b>Interested in saying hi?</b><br />
              <div class="contact-me">
              <a href="https://www.twitter.com/Smerity/" alt="Twitter"><i class="icon-twitter"></i></a><a href="https://facebook.com/smerity" alt="Facebook"><i class="icon-facebook-sign"></i></a><a href="https://github.com/Smerity/" alt="GitHub"><i class="icon-github"></i></a><a href="http://au.linkedin.com/in/smerity" alt="LinkedIn"><i class="icon-linkedin"></i></a><a href="mailto:smerity@smerity.com" alt="Email"><i class="icon-envelope-alt"></i></a>
              </div>
            </p>

            
          </div>
        </div>
      
      </div>
    
    
<footer>
  You reached the bottom! Reading can be challenging, so I think you deserve a reward. I'd offer you <a href="http://www.minecraftwiki.net/wiki/Cake">cake</a>, but after <a href="http://en.wikipedia.org/wiki/Portal_(video_game)">a certain robot-human conflict</a> started due to cake it may not be a wise choice. So here:
  <div align="center">
    <img src="/media/images/mini_coin.png" height="32" width="32" />
  </div>
  Take a coin. No, not a Bitcoin. Do you know how <a title="When I originally put this note here, Bitcoins were only a few dollars each...">expensive</a> those are? ಠ_ಠ
</footer>

  </div>
  
  
  <link rel="stylesheet" type="text/css" href="/media/css/fontawesome/fontawesome.css" />
  <!--[if lt IE 9]>
    <link rel="stylesheet" type="text/css" href="/media/css/fontawesome/fontawesome-ie7.css" />
  <![endif]-->
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,700' rel='stylesheet' type='text/css'>

  
  </body>
</html>